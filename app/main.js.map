{"version":3,"file":null,"sources":["/Users/normanpellet/Documents/Candlelight/code/app_public/source/main.js"],"sourcesContent":["const electron = require('electron');\nconst { Menu, ipcMain, dialog } = require('electron');\n// Module to control application life.\nconst app = electron.app;\n// Module to create native browser window.\nconst BrowserWindow = electron.BrowserWindow;\n\nconst path = require('path');\nconst url = require('url');\nconst fs = require('fs');\nconst request = require('request-promise-native');\nconst fix = require('fix-path');\nconst fetch = require('node-fetch');\nconst WebSocket = require('ws');\nconst environment = require('./environment.json');\nconst diagnostics = require('./app/scripts/diagnostics');\nconst { openForm, sendToForm } = require('./app/util/windows.js');\nfix();\n\nlet currentInstrument;\n\nconst configPath = path.join(\n  __dirname.replace('app.asar', 'app.asar.unpacked'),\n  '/config.json'\n);\nlet config = JSON.parse(fs.readFileSync(configPath));\n\nlet windows = {};\n\nipcMain.on('addInstrument', addInstrument);\nipcMain.on('editInstrument', editInstrument);\nipcMain.on('removeInstrument', removeInstrument);\nipcMain.on('loadInstrument', loadInstrument);\n\nipcMain.on('editInfluxDB', editInfluxDB);\nipcMain.on('updateInfluxDB', updateInfluxDB);\nipcMain.on('downloadData', downloadData);\nipcMain.on('htmlReport', htmlReport);\n\nipcMain.on('configChannel', configChannel);\nipcMain.on('configChannels', configChannels);\nipcMain.on('mppt', openMPPT);\nipcMain.on('bugReport', openBugReport);\nipcMain.on('calibratePD', openCalibratePD);\nipcMain.on('calibratePyranometer', openCalibratePyranometer);\nipcMain.on('scheduleLight', openScheduleLight);\n\nipcMain.on('reportError', reportError);\n\nipcMain.on('get-config', (event, arg) => {\n  event.sender.send('get-config', config);\n});\n\nfunction makeInstrumentMenu() {\n  return {\n    label: 'Instrument',\n    submenu: [\n      {\n        label: 'Diagnostics',\n        click() {\n          diagnostics.openDiagnostics(currentInstrument);\n        }\n      },\n      {\n        label: 'Add a new instrument',\n        click() {\n          addInstrument();\n        }\n      },\n      {\n        label: 'Edit instrument',\n        click() {\n          editInstrument(currentInstrument);\n        }\n      },\n      {\n        label: 'Edit database config',\n        click() {\n          editInfluxDB();\n        }\n      },\n      {\n        label: 'Show all measurements',\n        click() {\n          showAllMeasurements(currentInstrument);\n        }\n      },\n      { type: 'separator' },\n      { label: 'Cut', accelerator: 'CmdOrCtrl+X', selector: 'cut:' },\n      { label: 'Copy', accelerator: 'CmdOrCtrl+C', selector: 'copy:' },\n      { label: 'Paste', accelerator: 'CmdOrCtrl+V', selector: 'paste:' },\n\n      ...config.instruments.map(instrument => {\n        return {\n          label: instrument.trackerName,\n          checked: currentInstrument == instrument.trackerHost,\n          click(event) {\n            loadInstrument(event, instrument.trackerHost);\n          }\n        };\n      })\n    ]\n  };\n}\n\nfunction openSocket(instrumentConfig) {\n  const ws = new WebSocket(\n    'ws://' +\n      instrumentConfig.trackerHost +\n      ':' +\n      instrumentConfig.trackerPortWS\n  );\n\n  ws.on('open', function open() {\n    console.log('Socket is open');\n  });\n\n  ws.on('close', function open() {\n    console.log('Socket is closed');\n    setTimeout(() => openSocket(instrumentConfig), 1000);\n  });\n\n  ws.on('error', function error(err) {\n    console.log('Socket is in error state: ' + error.code);\n  });\n\n  ws.removeAllListeners('message');\n  ws.on('message', wsIncoming);\n\n  ws.isAlive = true;\n  ws.on('pong', () => (ws.isAlive = true));\n\n  var socketTimeout = () => {\n    let interval = setInterval(() => {\n      if (!ws.isAlive) {\n        ws.terminate();\n      }\n\n      if (ws.readyState == WebSocket.CLOSED) {\n        clearInterval(interval);\n      }\n\n      ws.isAlive = false;\n      ws.ping(() => {});\n    }, 30000);\n  };\n\n  socketTimeout();\n}\n\nfunction wsIncoming(data) {\n  data = JSON.parse(data);\n\n  if (!data.instrumentId && windows['instrumentMain']) {\n    windows['instrumentMain'].webContents.send(`instrument.log`, data.log);\n  }\n\n  if (data.instrumentId && windows['instrumentMain']) {\n    if (data.chanId) {\n      windows['instrumentMain'].webContents.send(\n        `channel.update.${data.instrumentId}.${data.chanId}`,\n        data\n      );\n    }\n\n    if (data.groupName) {\n      windows['instrumentMain'].webContents.send(\n        `group.update.${data.instrumentId}.${data.groupName}`,\n        data\n      );\n    }\n\n    if (data.log) {\n      data.log.time = Date.now();\n      windows['instrumentMain'].webContents.send(\n        `instrument.log.${data.instrumentId}`,\n        data.log\n      );\n    }\n  }\n}\n\nfunction doMenu() {\n  //require(\"./menu\");\n  const template = [];\n\n  if (environment.ageing) {\n    template.push(makeInstrumentMenu());\n  }\n\n  //if (process.platform === 'darwin') {\n  template.unshift({\n    label: app.getName(),\n    submenu: [\n      { role: 'about' },\n      { type: 'separator' },\n      { role: 'services', submenu: [] },\n      { type: 'separator' },\n      { role: 'hide' },\n      { role: 'hideothers' },\n      { role: 'unhide' },\n      { type: 'separator' },\n      { role: 'quit' }\n    ]\n  });\n\n  if (process.env.NODE_ENV == 'development') {\n    template[0].submenu.push({ role: 'toggledevtools' });\n  }\n  //}\n\n  const menu = Menu.buildFromTemplate(template);\n  Menu.setApplicationMenu(menu);\n}\n\nfunction saveConfig() {\n  return new Promise((resolver, rejecter) => {\n    fs.writeFile(configPath, JSON.stringify(config, undefined, '\\t'), error => {\n      if (error) {\n        reportError(error);\n        rejecter(error);\n      } else {\n        config = JSON.parse(fs.readFileSync(configPath));\n        resolver();\n      }\n    });\n  });\n}\n\n// Keep a global reference of the window object, if you don't, the window will\n// be closed automatically when the JavaScript object is garbage collected.\n\nfunction createMainWindow() {\n  // Create the browser window.\n  windows['instrumentList'] = new BrowserWindow({\n    width: 800,\n    height: 700,\n    resizable: false\n  });\n\n  windows['instrumentList'].webContents.once('dom-ready', () => {\n    windows['instrumentList'].webContents.send(\n      'dbInformation',\n      config.database\n    );\n  });\n\n  // and load the index.html of the app.\n  windows['instrumentList'].loadURL(\n    url.format({\n      pathname: path.join(__dirname, 'app/instrumentlist.html'),\n      protocol: 'file:',\n      slashes: true\n    })\n  );\n\n  // Open the DevTools.\n  // windows[ 'instrumentList' ].webContents.openDevTools()\n\n  // Emitted when the window is closed.\n  windows['instrumentList'].on('closed', function() {\n    // Dereference the window object, usually you would store windows\n    // in an array if your app supports multi windows, this is the time\n    // when you should delete the corresponding element.\n    windows['instrumentList'] = null;\n  });\n\n  doMenu();\n}\n\n// This method will be called when Electron has finished\n// initialization and is ready to create browser windows.\n// Some APIs can only be used after this event occurs.\napp.on('ready', createMainWindow);\n\n// Quit when all windows are closed.\napp.on('window-all-closed', function() {\n  // On OS X it is common for applications and their menu bar\n  // to stay active until the user quits explicitly with Cmd + Q\n  if (process.platform !== 'darwin') {\n    app.quit();\n  }\n});\n\napp.on('activate', function() {\n  // On OS X it's common to re-create a window in the app when the\n  // dock icon is clicked and there are no other windows open.\n  if (windows['instrumentList'] === null) {\n    createMainWindow();\n  }\n});\n\nasync function downloadData(\n  event,\n  tracker,\n  measurementName,\n  chanId,\n  instrumentId\n) {\n  let json = await fetch(\n    `http://${tracker.trackerHost}:${\n      tracker.trackerPort\n    }/getMeasurement?measurementName=${measurementName}`,\n    {\n      method: 'GET'\n    }\n  )\n    .then(response => response.json())\n    .catch(() => {\n      throw new Error(\n        `Error while connecting to the instrument. Check that you are online and that the instrument is available on your network.`\n      );\n    });\n\n  openForm(\n    null,\n    'downloadform',\n    {\n      measurementName: measurementName,\n      db: config.database,\n      cellInfo: json.cellInfo,\n      chanId: chanId,\n      instrumentId: instrumentId\n    },\n    {\n      width: 850,\n      height: 800,\n      resizable: false\n    }\n  )\n    .then(async result => {\n      config.instruments.push(result);\n      await saveConfig();\n      reloadInstruments();\n    })\n    .catch(() => {});\n}\n\nfunction htmlReport(event, cellInfo, chanId, measurementName, instrumentId) {\n  let listenerConfig, listenerSavePDF /*, listenerPrintPDF*/;\n\n  ipcMain.on(\n    'htmlReport.config',\n    (listenerConfig = (event, data) => {\n      if (!windows['htmlReport']) {\n        return;\n      }\n\n      windows['htmlReport'].webContents.send('config', data);\n    })\n  );\n\n  ipcMain.on(\n    'htmlReport.savePDF',\n    (listenerSavePDF = (event, data) => {\n      if (!windows['htmlReport']) {\n        return;\n      }\n\n      dialog.showSaveDialog(\n        {\n          message: 'Save the report for device ' + data.cellName,\n          defaultPath: '~/' + data.cellName + '.pdf'\n        },\n        fileName => {\n          if (!fileName) {\n            return;\n          }\n\n          windows['htmlReport'].webContents.printToPDF(\n            {\n              marginsType: 1,\n              pageSize: 'A4',\n              landscape: true\n            },\n            (err, data) => {\n              fs.writeFile(fileName, data, error => {\n                console.log(err);\n              });\n            }\n          );\n        }\n      );\n\n      //windows[ \"htmlReport\"].webContents.send( \"savePDF\", data );\n    })\n  );\n\n  /*\n\n    ipcMain.on(\"htmlReport.printPDF\", ( listenerPrintPDF = ( event, data ) => {\n\n      if( ! windows[ 'htmlReport' ] ) {\n        return;\n      }\n\n        windows[ 'htmlReport' ].webContents.print( {\n          marginsType: 1,\n          pageSize: 'A4',\n          landscape: true\n        }, ( err, data ) => {\n\n          fs.writeFile( fileName, data, ( error ) => {\n            console.log( err );\n          } );\n        } );\n\n      //windows[ \"htmlReport\"].webContents.send( \"savePDF\", data );\n    } ) );\n*/\n  openForm(\n    null,\n    'htmlreport_control',\n    {\n      measurementName: measurementName,\n      db: config.database,\n      cellInfo: cellInfo,\n      chanId: chanId\n    },\n    {\n      width: 400,\n      height: 595,\n      x: 50,\n      y: 100,\n      center: false,\n      resizable: false\n    },\n    () => {\n      ipcMain.removeListener('htmlReport.config', listenerConfig);\n      ipcMain.removeListener('htmlReport.savePDF', listenerSavePDF);\n      //     ipcMain.removeListener( \"htmlReport.printPDF\", listenerPrintPDF );\n    }\n  );\n\n  windows['htmlReport'] = new BrowserWindow({\n    width: 1122,\n    height: 795,\n    x: 500,\n    y: 100,\n    center: false,\n    resizable: false\n  });\n\n  windows['htmlReport'].webContents.once('dom-ready', () => {\n    windows['htmlReport'].webContents.send('loadData', {\n      measurementName: measurementName,\n      db: config.database,\n      cellInfo: cellInfo,\n      chanId: chanId,\n      instrumentId: instrumentId\n    });\n  });\n  // and load the index.html of the app.\n  windows['htmlReport'].loadURL(\n    url.format({\n      pathname: path.join(__dirname, 'app/htmlreport.html'),\n      protocol: 'file:',\n      slashes: true\n    })\n  );\n}\n\nfunction openBugReport(event) {\n  openForm(\n    null,\n    'bugreport',\n    {},\n    {\n      width: 540,\n      height: 600,\n      resizable: false\n    }\n  );\n}\n\nfunction openMPPT(keithleyModel) {\n  windows['mppt'] = new BrowserWindow({\n    width: 1400,\n    height: 1024,\n    center: true,\n    resizable: false\n  });\n  // and load the index.html of the app.\n  windows['mppt'].loadURL(\n    url.format({\n      pathname: path.join(__dirname, 'app/mppt.html'),\n      protocol: 'file:',\n      slashes: true\n    })\n  );\n}\n\nasync function openCalibratePD(event, data) {\n  openForm(\n    null,\n    'calibratepd',\n    {\n      instrumentId: data.instrumentId,\n      groupName: data.groupName,\n      config: data.config\n    },\n    {\n      width: 800,\n      height: 600,\n      resizable: false\n    },\n    async () => {\n      var channelConfig = await fetch(\n        'http://' +\n          data.config.trackerHost +\n          ':' +\n          data.config.trackerPort +\n          '/resetAllChannels?instrumentId=' +\n          data.instrumentId +\n          '&groupName=' +\n          data.groupName,\n        { method: 'GET' }\n      ).then(response => response.json());\n    }\n  );\n}\n\nasync function openCalibratePyranometer(event, data) {\n  openForm(\n    null,\n    'calibratepyranometer',\n    {\n      instrumentId: data.instrumentId,\n      groupName: data.groupName,\n      config: data.config\n    },\n    {\n      width: 800,\n      height: 600,\n      resizable: false\n    },\n    async () => {\n      //var channelConfig = await fetch( \"http://\" + data.config.trackerHost + \":\" + data.config.trackerPort + \"/resetAllChannels?instrumentId=\" + data.instrumentId + \"&groupName=\" + data.groupName, { method: 'GET' } ).then( ( response ) => response.json() );\n    }\n  );\n}\n\nasync function openScheduleLight(event, data) {\n  //await fetch( \"http://\" + data.config.trackerHost + \":\" +   data.config.trackerPort + \"/light.pause?instrumentId=\" + data.instrumentId, { method: 'GET' } );\n\n  // Once the light has been updated, send the information to the main window for update\n  let listener;\n  ipcMain.on(\n    'light.updated',\n    (listener = () => {\n      windows['instrumentMain'].webContents.send('light.updated');\n    })\n  );\n\n  openForm(\n    null,\n    'scheduleLight',\n    {\n      instrumentId: data.instrumentId,\n      groupName: data.groupName,\n      config: data.config\n    },\n    {\n      width: 800,\n      height: 600,\n      resizable: false\n    },\n    function() {\n      // After the window is closed, remove the listener\n      ipcMain.removeListener('light.updated', listener);\n      //  await fetch( \"http://\" + data.config.trackerHost + \":\" + data.config.trackerPort + \"/light.resume?instrumentId=\" + data.instrumentId, { method: 'GET' } );\n    }\n  );\n}\n\n// In this file you can include the rest of your app's specific main process\n// code. You can also put them in separate files and require them here.\n\nfunction removeInstrument(event, trackerHost) {\n  dialog.showMessageBox(\n    {\n      type: 'question',\n      message: 'Are you sure that you want to remove this instrument ?',\n      cancelId: 0,\n      defaultId: 0,\n      title: 'Remove the instrument',\n      buttons: ['Cancel', 'Yes']\n    },\n    async index => {\n      if (index == 1) {\n        config.instruments.forEach((instrument, index) => {\n          if (instrument.trackerHost == trackerHost) {\n            config.instruments.splice(index, 1);\n          }\n        });\n\n        await saveConfig();\n        reloadInstruments();\n      }\n    }\n  );\n}\n\nfunction reportError(e) {\n  console.log('Error reporting !');\n  dialog.showMessageBox(\n    {\n      type: 'error',\n      message: 'An error has happened: ' + e.toString(),\n      cancelId: 0,\n      defaultId: 0,\n      title: 'Error',\n      buttons: ['Ok']\n    },\n    index => {}\n  );\n}\n\nfunction reloadInstruments() {\n  windows['instrumentList'].webContents.send('reloadInstruments');\n  doMenu();\n}\n\nfunction addInstrument() {\n  openForm(\n    null,\n    'instrumentform',\n    {},\n    {\n      width: 850,\n      height: 800,\n      resizable: false\n    }\n  )\n    .then(async result => {\n      try {\n        config.instruments.push(result);\n        await saveConfig();\n        reloadInstruments();\n      } catch (e) {\n        reportError(e);\n      }\n    })\n    .catch(() => {});\n}\n\nfunction loadInstrument(event, tracker) {\n  const trackerHost = tracker.host;\n  const mode = tracker.mode;\n\n  if (!windows['instrumentMain']) {\n    // Create the browser window.\n    windows['instrumentMain'] = new BrowserWindow({\n      width: 1400,\n      height: 1024,\n      center: true,\n      resizable: true\n    });\n  }\n\n  switch (mode) {\n    case 'ageing':\n      windows['instrumentMain'].loadURL(\n        url.format({\n          pathname: path.join(__dirname, 'app/instrument.html'),\n          protocol: 'file:',\n          slashes: true\n        })\n      );\n      break;\n\n    case 'measurement':\n      windows['instrumentMain'].loadURL(\n        url.format({\n          pathname: path.join(__dirname, 'app/ivmeasurements/index.html'),\n          protocol: 'file:',\n          slashes: true\n        })\n      );\n\n      break;\n  }\n\n  if (windows['instrumentList']) {\n    windows['instrumentList'].close();\n  }\n\n  let instrumentConfig;\n\n  config.instruments.forEach((instrument, index) => {\n    if (instrument.trackerHost == trackerHost) {\n      instrumentConfig = instrument;\n      currentInstrument = instrument;\n    }\n  });\n\n  // Global\n\n  if (windows['instrumentMain'].webContents.isLoading()) {\n    windows['instrumentMain'].webContents.once('dom-ready', () => {\n      windows['instrumentMain'].webContents.send('loadInstrument', {\n        tracker: instrumentConfig,\n        db: config.database\n      });\n    });\n  } else {\n    windows['instrumentMain'].webContents.send('loadInstrument', {\n      tracker: instrumentConfig,\n      db: config.database\n    });\n  }\n\n  windows['instrumentMain'].once('close', () => {\n    windows['instrumentMain'] = null;\n  });\n\n  doMenu();\n\n  openSocket(instrumentConfig);\n}\n\nfunction editInstrument(event, trackerHost) {\n  let data;\n\n  config.instruments.forEach((instrument, index) => {\n    if (instrument.trackerHost == trackerHost) {\n      data = instrument;\n    }\n  });\n\n  if (!data) {\n    throw 'Could not find the data corresponding to this instrument';\n  }\n\n  openForm(null, 'instrumentform', data, {\n    width: 600,\n    height: 800,\n    resizable: false\n  })\n    .then(async results => {\n      Object.assign(data, results);\n      await saveConfig();\n\n      if (windows['instrumentMain']) {\n        windows['instrumentMain'].webContents.send('loadInstrument', {\n          tracker: data,\n          db: config.database\n        });\n      }\n\n      if (windows['instrumentList']) {\n        windows['instrumentList'].webContents.send('instrumentUpdated');\n      }\n\n      reloadInstruments();\n    })\n    .catch(() => {});\n}\n\nfunction editInfluxDB(event) {\n  let data;\n  let influxConfig = config.database;\n\n  openForm(null, 'influxdbform', influxConfig, {\n    width: 600,\n    height: 700,\n    resizable: false\n  })\n    .then(async results => {\n      config.database = results;\n\n      saveConfig();\n\n      sendToForm('uploading', {\n        status: 'progress',\n        host: config.instruments.map(i => i.trackerHost).join(', ')\n      });\n\n      updateInfluxDB()\n        .then(() => {\n          sendToForm('uploading', { status: 'done' });\n        })\n        .catch(err => {\n          sendToForm('uploading', {\n            status: 'error',\n            error: err,\n            host: err.options.host\n          });\n        });\n\n      if (windows['instrumentMain']) {\n        windows['instrumentMain'].webContents.send('reloadDB', {\n          db: config.database\n        });\n      }\n\n      if (windows['instrumentList']) {\n        windows['instrumentList'].webContents.send(\n          'dbInformation',\n          config.database\n        );\n      }\n    })\n    .catch(() => {});\n}\n\nfunction showAllMeasurements(instrument) {\n  console.log(instrument);\n  openForm(\n    null,\n    'showallmeasurements',\n    { config: instrument, configDB: config.database },\n    { width: 600, height: 700, resizable: false }\n  )\n    .then(results => {})\n    .catch(() => {});\n}\n\nfunction updateInfluxDB() {\n  return Promise.all(\n    config.instruments.map(instrument => {\n      return request.post({\n        url:\n          'http://' +\n          instrument.trackerHost +\n          ':' +\n          instrument.trackerPort +\n          '/setInfluxDB',\n        host: instrument.trackerHost,\n        form: config.database,\n        timeout: 1000\n      });\n    })\n  );\n}\n\nasync function configChannel(event, data) {\n  let influxConfig = config.database;\n\n  var channelConfig = await fetch(\n    'http://' +\n      data.trackerHost +\n      ':' +\n      data.trackerPort +\n      '/getChannelConfig?instrumentId=' +\n      data.instrumentId +\n      '&chanId=' +\n      data.chanId,\n    { method: 'GET' }\n  ).then(response => response.json());\n\n  var instrumentConfig = await fetch(\n    'http://' +\n      data.trackerHost +\n      ':' +\n      data.trackerPort +\n      '/getInstrumentConfig?instrumentId=' +\n      data.instrumentId,\n    { method: 'GET' }\n  ).then(response => response.json());\n\n  var channelState = await fetch(\n    'http://' +\n      data.trackerHost +\n      ':' +\n      data.trackerPort +\n      '/getStatus?instrumentId=' +\n      data.instrumentId +\n      '&chanId=' +\n      data.chanId,\n    { method: 'GET' }\n  ).then(response => response.json());\n\n  //var externalConnection = await fetch( \"http://\" + data.trackerHost + \":\" + data.trackerPort + \"/getChannelConfig?instrumentId=\" + data.instrumentId + \"&chanId=\" + data.chanId, { method: 'GET' } ).then( ( response ) => response.json() );\n  var externalConnection = false;\n\n  instrumentConfig.instrumentId = data.instrumentId;\n\n  return openForm(\n    null,\n    'cellform',\n    {\n      tracker: data,\n      instrumentConfig: instrumentConfig,\n      groupName: data.groupName,\n      channelConfig: channelConfig,\n      channelState: channelState[data.groupName].channels[data.chanId]\n    },\n    { width: 600, height: 800 }\n  )\n    .then(results => {\n      event.sender.send('channelConfigured', results);\n      return results;\n    })\n    .catch(() => {});\n}\n\nasync function configChannels(event, data) {\n  let influxConfig = config.database;\n\n  var channelsState = await fetch(\n    'http://' +\n      data.trackerHost +\n      ':' +\n      data.trackerPort +\n      '/getStatus?instrumentId=' +\n      data.instrumentId +\n      '&groupName=' +\n      data.groupName,\n    { method: 'GET' }\n  ).then(response => response.json());\n  var instrumentConfig = await fetch(\n    'http://' +\n      data.trackerHost +\n      ':' +\n      data.trackerPort +\n      '/getInstrumentConfig?instrumentId=' +\n      data.instrumentId,\n    { method: 'GET' }\n  ).then(response => response.json());\n  var channelState = await fetch(\n    'http://' +\n      data.trackerHost +\n      ':' +\n      data.trackerPort +\n      '/getStatus?instrumentId=' +\n      data.instrumentId +\n      '&chanId=' +\n      data.chanIds[0],\n    { method: 'GET' }\n  ).then(response => response.json());\n\n  instrumentConfig.instrumentId = data.instrumentId;\n\n  return openForm(\n    null,\n    'cellformall',\n    {\n      tracker: data,\n      channelState: channelState[data.groupName].channels[data.chanIds[0]],\n      channelsState: channelsState[data.groupName].channels,\n      groupName: data.groupName,\n      instrumentConfig: instrumentConfig,\n      channelIds: data.chanIds\n    },\n    { width: 600, height: 800 }\n  )\n    .then(results => {\n      event.sender.send('channelsConfigured', results);\n      return results;\n    })\n    .catch(() => {});\n}\n"],"names":["require","Menu","ipcMain","dialog","app","electron","BrowserWindow","path","url","fs","request","fix","fetch","WebSocket","environment","diagnostics","openForm","sendToForm","join","__dirname","replace","JSON","parse","readFileSync","configPath","windows","on","addInstrument","editInstrument","removeInstrument","loadInstrument","editInfluxDB","updateInfluxDB","downloadData","htmlReport","configChannel","configChannels","openMPPT","openBugReport","openCalibratePD","openCalibratePyranometer","openScheduleLight","reportError","event","sender","send","config","label","submenu","click","openDiagnostics","currentInstrument","showAllMeasurements","type","accelerator","selector","instruments","map","instrument","trackerName","checked","trackerHost","instrumentConfig","trackerPortWS","ws","console","log","setTimeout","openSocket","error","code","removeAllListeners","wsIncoming","isAlive","setInterval","terminate","readyState","CLOSED","clearInterval","interval","ping","data","instrumentId","webContents","chanId","groupName","time","Date","now","ageing","template","push","makeInstrumentMenu","unshift","getName","role","buildFromTemplate","setApplicationMenu","menu","resolver","rejecter","writeFile","stringify","width","height","resizable","once","database","loadURL","format","pathname","protocol","slashes","doMenu","createMainWindow","platform","quit","tracker","measurementName","trackerPort","method","then","response","json","catch","db","cellInfo","result","reloadInstruments","listenerSavePDF","listenerConfig","showSaveDialog","message","cellName","defaultPath","fileName","printToPDF","marginsType","pageSize","landscape","err","x","y","center","removeListener","listener","showMessageBox","cancelId","defaultId","title","buttons","forEach","index","splice","e","toString","host","mode","close","isLoading","Object","assign","results","influxConfig","saveConfig","status","i","options","configDB","all","post","form","timeout","channelState","channelConfig","channels","chanIds","channelsState","channelIds"],"mappings":"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"}